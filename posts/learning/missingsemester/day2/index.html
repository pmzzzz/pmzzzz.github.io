<!doctype html><html lang=zh-cn>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=robots content="noodp">
<title>MissingSemester day2 - 泡面zz的小屋</title><meta name=Description content="音乐｜技术｜资源"><meta property="og:title" content="MissingSemester day2">
<meta property="og:description" content="课程总结  shell脚本的基础知识，变量的使用以及shebang 常用工具的介绍，文件搜索工具和方法  重点内容 shell脚本 变量的定义和赋值 foo=bar 提示  空格在shell中十分敏感，切勿随意添加空格，如果写成 foo = bar它的意思是运行foo这个程序，第二和第三个参数分别为 = 和 bar，这明显不是我们想要的   变量的引用 echo $foo # 输出 bar 使用$来引用变量的值
单引号与双引号 foo=bar echo &#34;$foo&#34; # prints bar echo '$foo' # prints $foo 提示  从上面的例子可以看出，双引号会将其中的变量引用进行解释，而单引号是将其中的内容直接当作一个字符串。   特殊变量引用 若mcd.sh内容如下：
mcd () { mkdir -p &#34;$1&#34; cd &#34;$1&#34; } 该脚本的功能为 新建一个文件夹，然后自动cd进去
source mcd.sh mcd test 使用source file 将脚本的内容进行加载和执行，上面的例子即是将函数进行了加载
然后使用 mcd 命令来调用函数
 值得注意的是，在脚本中，我们使用了&#34;$1&#34;来表示接受到的第一个参数，在这个例子中，我们的参数是test,所以它会创建名为test的文件夹，然后cd进去
还有其他的特殊变量：">
<meta property="og:type" content="article">
<meta property="og:url" content="https://pmzzzt.eu.org/posts/learning/missingsemester/day2/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2024-01-02T21:00:00+08:00">
<meta property="article:modified_time" content="2023-01-02T21:00:00+08:00"><meta property="og:site_name" content="泡面zz的小屋">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="MissingSemester day2">
<meta name=twitter:description content="课程总结  shell脚本的基础知识，变量的使用以及shebang 常用工具的介绍，文件搜索工具和方法  重点内容 shell脚本 变量的定义和赋值 foo=bar 提示  空格在shell中十分敏感，切勿随意添加空格，如果写成 foo = bar它的意思是运行foo这个程序，第二和第三个参数分别为 = 和 bar，这明显不是我们想要的   变量的引用 echo $foo # 输出 bar 使用$来引用变量的值
单引号与双引号 foo=bar echo &#34;$foo&#34; # prints bar echo '$foo' # prints $foo 提示  从上面的例子可以看出，双引号会将其中的变量引用进行解释，而单引号是将其中的内容直接当作一个字符串。   特殊变量引用 若mcd.sh内容如下：
mcd () { mkdir -p &#34;$1&#34; cd &#34;$1&#34; } 该脚本的功能为 新建一个文件夹，然后自动cd进去
source mcd.sh mcd test 使用source file 将脚本的内容进行加载和执行，上面的例子即是将函数进行了加载
然后使用 mcd 命令来调用函数
 值得注意的是，在脚本中，我们使用了&#34;$1&#34;来表示接受到的第一个参数，在这个例子中，我们的参数是test,所以它会创建名为test的文件夹，然后cd进去
还有其他的特殊变量：">
<meta name=application-name content="泡面zz">
<meta name=apple-mobile-web-app-title content="泡面zz"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://pmzzzt.eu.org/posts/learning/missingsemester/day2/><link rel=prev href=https://pmzzzt.eu.org/posts/learning/missingsemester/day1/><link rel=next href=https://pmzzzt.eu.org/posts/learning/missingsemester/day3/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'>
<noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'>
<noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"MissingSemester day2","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/pmzzzt.eu.org\/posts\/learning\/missingsemester\/day2\/"},"genre":"posts","keywords":"MissingSemester, CS","wordcount":986,"url":"https:\/\/pmzzzt.eu.org\/posts\/learning\/missingsemester\/day2\/","datePublished":"2024-01-02T21:00:00+08:00","dateModified":"2023-01-02T21:00:00+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"泡面zz"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"light"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"light"==="dark")&&document.body.setAttribute("theme","dark")</script>
<div id=mask></div><div class=wrapper><header class=desktop id=header-desktop>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title=泡面zz的小屋><span class=header-title-pre><i class="fas fa-home" aria-hidden=true></i></span><span id=id-1 class=typeit></span><span class=header-title-post><i class="fas fa-hand-point-left" aria-hidden=true></i></span></a>
</div><div class=menu>
<div class=menu-inner><a class=menu-item href=/posts/><i class="fas fa-book"></i> 文章 </a><a class=menu-item href=/tags/><i class="fas fa-tags"></i> 标签 </a><a class=menu-item href=/categories/><i class="fas fa-table"></i> 分类 </a><a class=menu-item href=/search/><i class="fas fa-fw fa-search"></i> 搜索 </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a></div></div></div></header><header class=mobile id=header-mobile>
<div class=header-container>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title=泡面zz的小屋><span class=header-title-pre><i class="fas fa-home" aria-hidden=true></i></span><span id=id-2 class=typeit></span><span class=header-title-post><i class="fas fa-hand-point-left" aria-hidden=true></i></span></a>
</div><div class=menu-toggle id=menu-toggle-mobile>
<span></span><span></span><span></span>
</div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title><i class="fas fa-book"></i>文章</a><a class=menu-item href=/tags/ title><i class="fas fa-tags"></i>标签</a><a class=menu-item href=/categories/ title><i class="fas fa-table"></i>分类</a><a class=menu-item href=/search/ title><i class="fas fa-fw fa-search"></i>搜索</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a></div></div></header><main class=main>
<div class=container>
<div class=toc id=toc-auto>
<h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">MissingSemester day2</h1><div class=post-meta>
<div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>泡面zz</a></span>&nbsp;<span class=post-category>收录于 <a href=/categories/%E5%AD%A6%E4%B9%A0/><i class="far fa-folder fa-fw" aria-hidden=true></i>学习</a>&nbsp;<a href=/categories/missingsemester/><i class="far fa-folder fa-fw" aria-hidden=true></i>MissingSemester</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2024-01-02>2024-01-02</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;约 986 字&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;预计阅读 5 分钟&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=/posts/learning/missingsemester/day2/1.png data-srcset="/posts/learning/missingsemester/day2/1.png, /posts/learning/missingsemester/day2/1.png 1.5x, /posts/learning/missingsemester/day2/1.png 2x" data-sizes=auto alt=/posts/learning/missingsemester/day2/1.png title=/posts/learning/missingsemester/day2/1.png width=1280 height=640></div><div class="details toc" id=toc-static data-kept>
<div class="details-summary toc-title">
<span>目录</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span>
</div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents>
<ul>
<li><a href=#课程总结>课程总结</a></li><li><a href=#重点内容>重点内容</a>
<ul>
<li><a href=#shell脚本>shell脚本</a></li><li><a href=#shell工具>shell工具</a></li></ul></li><li><a href=#作业>作业</a></li></ul></nav></div></div><div class=content id=content><h2 id=课程总结>课程总结</h2><ol>
<li>shell脚本的基础知识，变量的使用以及shebang</li><li>常用工具的介绍，文件搜索工具和方法</li></ol><h2 id=重点内容>重点内容</h2><h3 id=shell脚本>shell脚本</h3><h4 id=变量的定义和赋值>变量的定义和赋值</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nv>foo</span><span class=o>=</span>bar
</span></span></code></pre></div><div class="details admonition tip open">
<div class="details-summary admonition-title">
<i class="icon fas fa-lightbulb fa-fw" aria-hidden=true></i>提示<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i>
</div><div class=details-content>
<div class=admonition-content><strong>空格</strong>在shell中十分敏感，切勿随意添加空格，如果写成 <code>foo = bar</code>它的意思是运行<code>foo</code>这个程序，第二和第三个参数分别为 = 和 bar，这明显不是我们想要的</div></div></div><h4 id=变量的引用>变量的引用</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>$foo</span>
</span></span><span class=line><span class=cl><span class=c1># 输出 bar</span>
</span></span></code></pre></div><p>使用<code>$</code>来引用变量的值</p><h4 id=单引号与双引号>单引号与双引号</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nv>foo</span><span class=o>=</span>bar
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;</span><span class=nv>$foo</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># prints bar</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s1>&#39;$foo&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># prints $foo</span>
</span></span></code></pre></div><div class="details admonition tip open">
<div class="details-summary admonition-title">
<i class="icon fas fa-lightbulb fa-fw" aria-hidden=true></i>提示<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i>
</div><div class=details-content>
<div class=admonition-content>从上面的例子可以看出，双引号会将其中的变量引用进行解释，而单引号是将其中的内容直接当作一个字符串。</div></div></div><h4 id=特殊变量引用>特殊变量引用</h4><p>若<code>mcd.sh</code>内容如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>mcd <span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    mkdir -p <span class=s2>&#34;</span><span class=nv>$1</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>cd</span> <span class=s2>&#34;</span><span class=nv>$1</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>该脚本的功能为 新建一个文件夹，然后自动cd进去</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nb>source</span> mcd.sh
</span></span><span class=line><span class=cl>mcd <span class=nb>test</span>
</span></span></code></pre></div><p>使用source file 将脚本的内容进行加载和执行，上面的例子即是将函数进行了加载</p><p>然后使用 <code>mcd</code> 命令来调用函数</p><hr>
<p>值得注意的是，在脚本中，我们使用了<code>"$1"</code>来表示接受到的第一个参数，在这个例子中，我们的参数是<code>test</code>,所以它会创建名为<code>test</code>的文件夹，然后<code>cd</code>进去</p><p><strong>还有其他的特殊变量：</strong></p><table>
<thead>
<tr>
<th style=text-align:center>名称</th><th style=text-align:center>意义</th></tr></thead><tbody>
<tr>
<td style=text-align:center><code>$0</code></td><td style=text-align:center>脚本名</td></tr><tr>
<td style=text-align:center><code>$1</code>到 <code>$9</code></td><td style=text-align:center>脚本的参数。 <code>$1</code> 是第一个参数，依此类推。</td></tr><tr>
<td style=text-align:center><code>$@</code></td><td style=text-align:center>所有参数</td></tr><tr>
<td style=text-align:center><code>$#</code></td><td style=text-align:center>参数个数</td></tr><tr>
<td style=text-align:center><code>$?</code></td><td style=text-align:center>前一个命令的返回值</td></tr><tr>
<td style=text-align:center><code>$$</code></td><td style=text-align:center>当前脚本的进程识别码</td></tr><tr>
<td style=text-align:center><code>!!</code></td><td style=text-align:center>完整的上一条命令，包括参数。常见应用：当你因为权限不足执行命令失败时，可以使用 <code>sudo !!</code>再尝试一次。</td></tr><tr>
<td style=text-align:center><code>$_</code></td><td style=text-align:center>上一条命令的最后一个参数。如果你正在使用的是交互式 shell，你可以通过按下 <code>Esc</code> 之后键入 . 来获取这个值。</td></tr></tbody></table><h4 id=短接-short-circuitinghttpsenwikipediaorgwikishort-circuit_evaluation>短接 <a href=https://en.wikipedia.org/wiki/Short-circuit_evaluation target=_blank rel="noopener noreffer">short-circuiting</a></h4><p>与C语言一样，逻辑表达式的执行，采用短接的形式，也就是说：当前面的语句已经能判断真假，后续的语句将不再执行</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nb>false</span> <span class=o>||</span> <span class=nb>echo</span> <span class=s2>&#34;Oops, fail&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># Oops, fail</span>
</span></span><span class=line><span class=cl><span class=nb>true</span> <span class=o>||</span> <span class=nb>echo</span> <span class=s2>&#34;Will not be printed&#34;</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=nb>true</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span> <span class=s2>&#34;Things went well&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># Things went well</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>false</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span> <span class=s2>&#34;Will not be printed&#34;</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=nb>true</span> <span class=p>;</span> <span class=nb>echo</span> <span class=s2>&#34;This will always run&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># This will always run</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>false</span> <span class=p>;</span> <span class=nb>echo</span> <span class=s2>&#34;This will always run&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># This will always run</span>
</span></span></code></pre></div><p>在这个例子中，<code>||</code>和<code>&&</code>使用了短接，而<code>;</code>代表将两个语句分割，没有短接效果。</p><h4 id=参数的综合运用>参数的综合运用</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Starting program at </span><span class=k>$(</span>date<span class=k>)</span><span class=s2>&#34;</span> <span class=c1># Date will be substituted</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Running program </span><span class=nv>$0</span><span class=s2> with </span><span class=nv>$#</span><span class=s2> arguments with pid </span><span class=nv>$$</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> file in <span class=s2>&#34;</span><span class=nv>$@</span><span class=s2>&#34;</span><span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    grep foobar <span class=s2>&#34;</span><span class=nv>$file</span><span class=s2>&#34;</span> &gt; /dev/null 2&gt; /dev/null
</span></span><span class=line><span class=cl>    <span class=c1># When pattern is not found, grep has exit status 1</span>
</span></span><span class=line><span class=cl>    <span class=c1># We redirect STDOUT and STDERR to a null register since we do not care about them</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>[[</span> <span class=nv>$?</span> -ne <span class=m>0</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;File </span><span class=nv>$file</span><span class=s2> does not have any foobar, adding one&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;# foobar&#34;</span> &gt;&gt; <span class=s2>&#34;</span><span class=nv>$file</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>(</span>base<span class=o>)</span> ➜  day2 ./example.sh example.sh mcd.sh
</span></span><span class=line><span class=cl>Starting program at 2023年12月29日 星期五 23时48分43秒 CST
</span></span><span class=line><span class=cl>Running program ./example.sh with <span class=m>2</span> arguments with pid <span class=m>96149</span>
</span></span><span class=line><span class=cl>File mcd.sh does not have any foobar, adding one
</span></span></code></pre></div><ul>
<li>在shell中，不同的输出被分到了不同的流，2> 代表了错误流。> 代表标准输出流</li><li>-ne(not equal) 可以通过 <code>man test</code> 查看其他比较运算符</li><li>在进行比较时，推荐使用两个中括号<code>[[ ]]</code></li></ul><h4 id=通配符globbing>通配符<em>globbing</em></h4><ul>
<li><code>*</code>代表若干字符</li><li><code>?</code>代表一个字符</li><li><code>{}</code>会进行笛卡尔积扩展</li></ul><p>例如：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>*.py <span class=c1>#所有以.py结尾的文件</span>
</span></span><span class=line><span class=cl>?.py <span class=c1>#前有一个字符，且以.py 结尾的文件</span>
</span></span><span class=line><span class=cl>a.<span class=o>{</span>jpg,png<span class=o>}</span> <span class=c1># a.jpg 和 a.png</span>
</span></span><span class=line><span class=cl><span class=o>{</span>a,b<span class=o>}</span>.<span class=o>{</span>c,d<span class=o>}</span> <span class=c1># a.c、a.d、b.c、b.d 四个文件</span>
</span></span></code></pre></div><h4 id=shebang>shebang</h4><p>shebang的意义在于，告诉shell应该用什么解释器来执行某个脚本，它是写在脚本第一行的提示词，常见的shebang为<code>#!/bin/bash</code>这表示使用bash来执行这个脚本</p><p><code>example.py</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/local/bin/python</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>arg</span> <span class=ow>in</span> <span class=nb>reversed</span><span class=p>(</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>:]):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>arg</span><span class=p>)</span>
</span></span></code></pre></div><p>以上为一个python脚本，为了让shell知道使用哪个解释器我们添加了shebang:<code>#!/usr/local/bin/python</code></p><h4 id=更好的shebang>更好的shebang</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python</span>
</span></span></code></pre></div><p>以上的shebang首先使用了env命令（这在unix like 机器中很常见），然后利用env命令找到这台机器的python解释器（即是环境变量、也是之前提到的path路径）</p><h3 id=shell工具>shell工具</h3><h4 id=tldr---简介明了的命令解释>tldr - 简介明了的命令解释</h4><p>tldr 是man的增强，它以更接近人类的语言描述命令的使用方法（需要第三方安装）</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>tldr ffmpeg <span class=c1>#查看ffmpeg的使用方法</span>
</span></span></code></pre></div><h4 id=find---查找文件>find - 查找文件</h4><h4 id=fd-find增强>fd-find增强</h4><h4 id=locate-速度极快>locate-速度极快</h4><h2 id=作业>作业</h2><ol>
<li>
<p>Read <a href=https://www.man7.org/linux/man-pages/man1/ls.1.html target=_blank rel="noopener noreffer"><code>man ls</code></a> and write an <code>ls</code> command that lists files in the following manner</p><ul>
<li>Includes all files, including hidden files</li><li>Sizes are listed in human readable format (e.g. 454M instead of 454279954)</li><li>Files are ordered by recency</li><li>Output is colorized</li></ul><p>A sample output would look like this</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl> -rw-r--r--   <span class=m>1</span> user group 1.1M Jan <span class=m>14</span> 09:53 baz
</span></span><span class=line><span class=cl> drwxr-xr-x   <span class=m>5</span> user group  <span class=m>160</span> Jan <span class=m>14</span> 09:53 .
</span></span><span class=line><span class=cl> -rw-r--r--   <span class=m>1</span> user group  <span class=m>514</span> Jan <span class=m>14</span> 06:42 bar
</span></span><span class=line><span class=cl> -rw-r--r--   <span class=m>1</span> user group 106M Jan <span class=m>13</span> 12:12 foo
</span></span><span class=line><span class=cl> drwx------+ <span class=m>47</span> user group 1.5K Jan <span class=m>12</span> 18:08 ..
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ls -a -l -h -t --color<span class=o>=</span>auto
</span></span></code></pre></div></li><li>
<p>Write bash functions <code>marco</code> and <code>polo</code> that do the following. Whenever you execute <code>marco</code> the current working directory should be saved in some manner, then when you execute <code>polo</code>, no matter what directory you are in, <code>polo</code> should <code>cd</code> you back to the directory where you executed <code>marco</code>. For ease of debugging you can write the code in a file <code>marco.sh</code> and (re)load the definitions to your shell by executing <code>source marco.sh</code>.
文件<code>marco.sh</code>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1># Function to save the current directory</span>
</span></span><span class=line><span class=cl>marco<span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=nb>export</span> <span class=nv>MARCO_DIR</span><span class=o>=</span><span class=k>$(</span><span class=nb>pwd</span><span class=k>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;Current directory saved as MARCO_DIR&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=c1># Function to change directory back to the saved directory</span>
</span></span><span class=line><span class=cl>polo<span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=nb>cd</span> <span class=s2>&#34;</span><span class=nv>$MARCO_DIR</span><span class=s2>&#34;</span> <span class=o>||</span> <span class=nb>echo</span> <span class=s2>&#34;MARCO_DIR is not set&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nb>source</span> marco.sh
</span></span></code></pre></div></li><li>
<p>Say you have a command that fails rarely. In order to debug it you need to capture its output but it can be time consuming to get a failure run. Write a bash script that runs the following script until it fails and captures its standard output and error streams to files and prints everything at the end. Bonus points if you can also report how many runs it took for the script to fail.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl> <span class=c1>#!/usr/bin/env bash</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=nv>n</span><span class=o>=</span><span class=k>$((</span> RANDOM <span class=o>%</span> <span class=m>100</span> <span class=k>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=k>if</span> <span class=o>[[</span> n -eq <span class=m>42</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;Something went wrong&#34;</span>
</span></span><span class=line><span class=cl>    &gt;<span class=p>&amp;</span><span class=m>2</span> <span class=nb>echo</span> <span class=s2>&#34;The error was using magic numbers&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>exit</span> <span class=m>1</span>
</span></span><span class=line><span class=cl> <span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=nb>echo</span> <span class=s2>&#34;Everything went according to plan&#34;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=cp>#!/usr/bin/env bash 
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=c1># Output and error log files</span>
</span></span><span class=line><span class=cl><span class=nv>output_log</span><span class=o>=</span><span class=s2>&#34;output.log&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>error_log</span><span class=o>=</span><span class=s2>&#34;error.log&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>counter</span><span class=o>=</span><span class=m>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Function to run the given script until failure</span>
</span></span><span class=line><span class=cl>run_script<span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> true<span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> ! ./quz3.sh &gt;&gt; <span class=s2>&#34;</span><span class=nv>$output_log</span><span class=s2>&#34;</span> 2&gt;&gt; <span class=s2>&#34;</span><span class=nv>$error_log</span><span class=s2>&#34;</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>            <span class=nb>break</span>
</span></span><span class=line><span class=cl>        <span class=k>fi</span>
</span></span><span class=line><span class=cl>        <span class=o>((</span>counter++<span class=o>))</span>
</span></span><span class=line><span class=cl>    <span class=k>done</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Run the script and capture output/errors</span>
</span></span><span class=line><span class=cl>run_script
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Print captured logs</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Final Output:&#34;</span>
</span></span><span class=line><span class=cl>cat <span class=s2>&#34;</span><span class=nv>$output_log</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Final Errors:&#34;</span>
</span></span><span class=line><span class=cl>cat <span class=s2>&#34;</span><span class=nv>$error_log</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Number of runs until failure: </span><span class=nv>$counter</span><span class=s2>&#34;</span>
</span></span></code></pre></div></li><li>
<p>As we covered in the lecture <code>find</code>’s <code>-exec</code> can be very powerful for performing operations over the files we are searching for. However, what if we want to do something with <strong>all</strong> the files, like creating a zip file? As you have seen so far commands will take input from both arguments and STDIN. When piping commands, we are connecting STDOUT to STDIN, but some commands like <code>tar</code> take inputs from arguments. To bridge this disconnect there’s the <a href=https://www.man7.org/linux/man-pages/man1/xargs.1.html target=_blank rel="noopener noreffer"><code>xargs</code></a> command which will execute a command using STDIN as arguments. For example <code>ls | xargs rm</code> will delete the files in the current directory.</p><p>Your task is to write a command that recursively finds all HTML files in the folder and makes a zip with them. Note that your command should work even if the files have spaces (hint: check <code>-d</code> flag for <code>xargs</code>).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>find /your/directory/path -type f -name <span class=s1>&#39;*.html&#39;</span> -print0 <span class=p>|</span> xargs -0 zip html_files.zip
</span></span></code></pre></div><blockquote>
<p>-print0 和-0表示以\0为分隔符而不是空格，这样就能保证有空格的文件能被正确识别</p><p>-dX 表示以X为分隔符</p></blockquote><p>If you’re on macOS, note that the default BSD <code>find</code> is different from the one included in <a href=https://en.wikipedia.org/wiki/List_of_GNU_Core_Utilities_commands target=_blank rel="noopener noreffer">GNU coreutils</a>. You can use <code>-print0</code> on <code>find</code> and the <code>-0</code> flag on <code>xargs</code>. As a macOS user, you should be aware that command-line utilities shipped with macOS may differ from the GNU counterparts; you can install the GNU versions if you like by <a href=https://formulae.brew.sh/formula/coreutils target=_blank rel="noopener noreffer">using brew</a>.</p></li><li>
<p>(Advanced) Write a command or script to recursively find the most recently modified file in a directory. More generally, can you list all files by recency?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl> ls -t -1 -r /your/directory/path <span class=p>|</span> head -n <span class=m>1</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ls -t -1 -r /your/directory/path
</span></span></code></pre></div></li></ol><ul>
<li>-t表示按照时间排序</li><li>-1表示一行显示一个文件</li><li>-r表示递归</li></ul><div class=post-reward>
<input type=checkbox name=reward id=reward hidden>
<label class=reward-button for=reward>赞赏支持</label>
<div class=qr-code>
<label class=qr-code-image for=reward>
<img class=image src=/imgs/coffee/wechat.png>
<span>微信打赏</span>
</label>
<label class=qr-code-image for=reward>
<img class=image src=/imgs/coffee/alipay.png>
<span>支付宝打赏</span>
</label>
</div></div></div><div class=post-footer id=post-footer>
<div class=post-info>
<div class=post-info-line>
<div class=post-info-mod>
<span>更新于 2023-01-02</span>
</div></div><div class=post-info-line>
<div class=post-info-md></div><div class=post-info-share>
<span><a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://pmzzzt.eu.org/posts/learning/missingsemester/day2/ data-hashtag=MissingSemester><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Reddit" data-sharer=reddit data-url=https://pmzzzt.eu.org/posts/learning/missingsemester/day2/><i class="fab fa-reddit fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://pmzzzt.eu.org/posts/learning/missingsemester/day2/ data-title="MissingSemester day2" data-image=1.png><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span>
</div></div></div><div class=post-info-more>
<section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/missingsemester/>MissingSemester</a>,&nbsp;<a href=/tags/cs/>CS</a></section><section>
<span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span>
</section></div><div class=post-nav><a href=/posts/learning/missingsemester/day1/ class=prev rel=prev title="MissingSemester day1"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>MissingSemester day1</a>
<a href=/posts/learning/missingsemester/day3/ class=next rel=next title="MissingSemester day3">MissingSemester day3<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=waline></div><script src=https://cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js></script>
<script>new Waline({el:"#waline",meta:["nick","mail","link"],requiredMeta:["nick","mail"],login:"force",placeholder:"为防恶意灌水攻击，评论前需注册并登录，望见谅~",serverURL:"https://waline-pmzzzz.vercel.app/",avatarCDN:"https://sdn.geekzu.org/avatar/",pageSize:20,avatar:"retro",lang:"zh-CN",visitor:!0,highlight:!0,uploadImage:!1})</script></div></article></div></main><footer class=footer>
<div class=footer-container><div class=footer-line>
<span id=run-time></span>
</div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2023 - 2024</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>泡面zz</a></span>&nbsp;|&nbsp;<span class=license><a href=https://creativecommons.org/licenses/by-nc/4.0>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部>
<i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论>
<i class="fas fa-comment fa-fw" aria-hidden=true></i>
</a>
</div><div class=sidebar_wo>
<div id=leimu>
<img src=https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/leimuA.png alt=雷姆 onmouseover='this.src="https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/leimuB.png"' onmouseout='this.src="https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/leimuA.png"' title=回到顶部>
</div><div class=sidebar_wo id=lamu>
<img src=https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/lamuA.png alt=雷姆 onmouseover='this.src="https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/lamuB.png"' onmouseout='this.src="https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/lamuA.png"' title=回到底部>
</div></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:50},comment:{},data:{"id-1":"小屋客厅","id-2":"小屋客厅"},lightgallery:!0,typeit:{cursorChar:"|",cursorSpeed:1e3,data:{"id-1":["id-1"],"id-2":["id-2"]},duration:-1,speed:100}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/jquery@2.1.3/dist/jquery.min.js></script>
<script type=text/javascript src=https://cdn.jsdelivr.net/npm/jquery-backstretch@2.1.18/jquery.backstretch.min.js></script><script type=text/javascript src=/js/custom.js></script></body></html>